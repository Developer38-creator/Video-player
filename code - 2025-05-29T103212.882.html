<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Reels-like App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
          integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000;
            margin: 0;
            overflow: hidden;
            height: 100vh;
        }

        video::-internal-media-controls-overlay-cast-button,
        video::-webkit-media-controls {
            display: none !important;
        }

        .animate-pulse {
            animation: pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
    </style>
</head>
<body>
<div id="app" class="relative w-screen h-screen overflow-hidden">
    <div
            id="videos-container"
            class="w-full h-full snap-y snap-mandatory overflow-y-scroll scroll-smooth"
            tabindex="0"
            aria-label="Instagram Reels style video feed"
    >
        <!-- Video items will be injected here -->
    </div>

    <div
            id="overlay"
            class="pointer-events-none absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/90 to-transparent text-white flex flex-col justify-end space-y-4"
    >
        <div id="video-title" class="text-xl font-semibold drop-shadow-lg"></div>
        <div class="flex items-center space-x-6 pointer-events-auto">
            <button
                    id="btn-like"
                    aria-label="Like video"
                    class="flex items-center space-x-2 text-white hover:text-red-500 transition"
            >
                <i class="fas fa-heart fa-lg"></i>
                <span id="like-count" class="text-lg select-none">0</span>
            </button>
            <button
                    id="btn-comment"
                    aria-label="Comment on video"
                    class="flex items-center space-x-2 text-white hover:text-blue-400 transition"
            >
                <i class="fas fa-comment fa-lg"></i>
                <span class="text-lg select-none">Comment</span>
            </button>
            <button
                    id="btn-share"
                    aria-label="Share video"
                    class="flex items-center space-x-2 text-white hover:text-green-400 transition"
            >
                <i class="fas fa-share fa-lg"></i>
                <span class="text-lg select-none">Share</span>
            </button>
        </div>
    </div>
    <!-- Comment Section -->
    <div id="comment-section" class="hidden absolute top-0 left-0 w-full h-full bg-black/80 z-10">
        <div class="relative p-4">
            <button id="close-comment-section" class="absolute top-2 right-2 text-white"><i
                        class="fas fa-times"></i></button>
            <h2 class="text-white text-xl mb-4">Comments</h2>
            <!-- Fake comments -->
            <div class="space-y-2">
                <div class="text-gray-300">This is a fake comment.</div>
                <div class="text-gray-300">Another fake comment.</div>
            </div>
        </div>
    </div>
    <div
            id="nav-dots"
            class="pointer-events-auto absolute top-1/2 right-4 -translate-y-1/2 flex flex-col space-y-3"
            aria-label="Video navigation dots"
    >
        <!-- Dots will be injected here -->
    </div>
</div>

<script>
    const videos = [
        {
            src: 'https://placehold.co/720x1280/mp4?text=Instagram+video+1',
            title: 'Instagram video ðŸ“·',
            thumbnail:
                'https://placehold.co/720x1280/png?text=Thumbnail+Instagram+video+1&font=roboto',
        },
        {
            src: 'https://placehold.co/720x1280/mp4?text=Video+2',
            title: 'Video 2',
            thumbnail: 'https://placehold.co/720x1280/png?text=Thumbnail+Video+2&font=roboto',
        },
        {
            src: 'https://placehold.co/720x1280/mp4?text=Video+3',
            title: 'Video 3',
            thumbnail: 'https://placehold.co/720x1280/png?text=Thumbnail+Video+3&font=roboto',
        },
        {
            src: 'https://placehold.co/720x1280/mp4?text=Video+4',
            title: 'Video 4',
            thumbnail: 'https://placehold.co/720x1280/png?text=Thumbnail+Video+4&font=roboto',
        },
        {
            src: 'https://placehold.co/720x1280/mp4?text=Video+5',
            title: 'Video 5',
            thumbnail: 'https://placehold.co/720x1280/png?text=Thumbnail+Video+5&font=roboto',
        },
        {
            src: 'https://placehold.co/720x1280/mp4?text=Video+6',
            title: 'Video 6',
            thumbnail: 'https://placehold.co/720x1280/png?text=Thumbnail+Video+6&font=roboto',
        },
        {
            src: 'https://placehold.co/720x1280/mp4?text=Video+7',
            title: 'Video 7',
            thumbnail: 'https://placehold.co/720x1280/png?text=Thumbnail+Video+7&font=roboto',
        },
    ];

    const videosContainer = document.getElementById('videos-container');
    const videoTitle = document.getElementById('video-title');
    const navDots = document.getElementById('nav-dots');
    const likeBtn = document.getElementById('btn-like');
    const likeCountSpan = document.getElementById('like-count');

    const commentBtn = document.getElementById('btn-comment');
    const commentSection = document.getElementById('comment-section');
    const closeCommentSectionBtn = document.getElementById('close-comment-section');

    const shareBtn = document.getElementById('btn-share');

    // State
    let currentIndex = 0;
    const likes = new Array(videos.length).fill(0);

    // Create video elements
    videos.forEach((video, index) => {
        const videoWrapper = document.createElement('div');
        videoWrapper.className =
            'snap-start w-full h-screen relative flex items-center justify-center bg-black';

        const vid = document.createElement('video');
        vid.setAttribute('playsinline', '');
        vid.setAttribute('webkit-playsinline', '');
        vid.setAttribute('preload', 'metadata');
        vid.setAttribute('muted', '');
        vid.setAttribute('loop', 'false');
        vid.className = 'w-full h-full object-cover';
        vid.src = video.src;
        vid.poster = video.thumbnail;
        vid.setAttribute('aria-label', video.title);
        vid.setAttribute('tabindex', '-1'); // Make video focusable

        vid.addEventListener('ended', () => {
            goToNextVideo();
        });

        vid.addEventListener('canplay', () => {
            if (index === currentIndex) {
                vid.play().catch(() => {
                });
                vid.focus(); // Set focus to current video
            }
        });

        vid.addEventListener('dblclick', (e) => {
            e.preventDefault();
            likeVideo(index);
            showLikeAnimation(e.clientX, e.clientY, index);
        });

        videoWrapper.appendChild(vid);
        videosContainer.appendChild(videoWrapper);
    });

    // Event Listeners
    commentBtn.addEventListener('click', () => {
        commentSection.classList.remove('hidden');
    });

    closeCommentSectionBtn.addEventListener('click', () => {
        commentSection.classList.add('hidden');
    });

    shareBtn.addEventListener('click', () => {
        alert("Share feature (Not implemented)."); // Replace with actual share logic or modal.
    });

    function likeVideo(index) {
        likes[index]++;
        likeCountSpan.textContent = likes[index];
        likeBtn.classList.add('text-red-500');
        setTimeout(() => {
            likeBtn.classList.remove('text-red-500');
        }, 800);
    }

    function showLikeAnimation(x, y, index) {
        const heart = document.createElement('i');
        heart.className = 'fas fa-heart fa-3x absolute text-red-500 animate-pulse';
        heart.style.left = `${x}px`;
        heart.style.top = `${y}px`;

        const videoWrapper = videosContainer.children[index];
        videoWrapper.appendChild(heart);

        setTimeout(() => {
            heart.remove();
        }, 1000);
    }

    // Create navigation dots
    videos.forEach((_, index) => {
        const dot = document.createElement('button');
        dot.className =
            'w-3 h-3 rounded-full bg-white/50 hover:bg-white transition';
        dot.setAttribute('aria-label', `Go to video ${index + 1}`);
        dot.addEventListener('click', () => {
            scrollToVideo(index);
        });
        navDots.appendChild(dot);
    });

    // Update UI for current video
    function updateUI() {
        videoTitle.textContent = videos[currentIndex].title;
        likeCountSpan.textContent = likes[currentIndex];
        updateNavDots();
    }

    // Update nav dots active state
    function updateNavDots() {
        Array.from(navDots.children).forEach((dot, idx) => {
            if (idx === currentIndex) {
                dot.classList.add('bg-white');
                dot.classList.remove('bg-white/50');
                dot.setAttribute('aria-current', 'true');
            } else {
                dot.classList.remove('bg-white');
                dot.classList.add('bg-white/50');
                dot.removeAttribute('aria-current');
            }
        });
    }

    // Scroll to a specific video index
    function scrollToVideo(index) {
        if (index < 0) index = videos.length - 1;
        if (index >= videos.length) index = 0;
        currentIndex = index;
        const videoHeight = window.innerHeight;
        videosContainer.scrollTo({
            top: videoHeight * index,
            behavior: 'smooth',
        });
        pauseAllVideos();
        playCurrentVideo();
        updateUI();
    }

    // Pause all videos
    function pauseAllVideos() {
        const vids = videosContainer.querySelectorAll('video');
        vids.forEach((v) => {
            v.pause();
        });
    }

    // Play current video
    function playCurrentVideo() {
        const vids = videosContainer.querySelectorAll('video');
        const currentVideo = vids[currentIndex];
        if (currentVideo) {
            currentVideo.currentTime = 0;
            currentVideo.play().catch(() => {
            });
        }
    }

    // Go to next video (loops to first after last)
    function goToNextVideo() {
        let nextIndex = currentIndex + 1;
        if (nextIndex >= videos.length) nextIndex = 0;
        scrollToVideo(nextIndex);
    }

    // Detect scroll to update current video index and play/pause accordingly
    let scrollTimeout;
    videosContainer.addEventListener('scroll', () => {
        if (scrollTimeout) clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(() => {
            const scrollTop = videosContainer.scrollTop;
            const videoHeight = window.innerHeight;
            const index = Math.round(scrollTop / videoHeight);
            if (index !== currentIndex) {
                currentIndex = index;
                pauseAllVideos();
                playCurrentVideo();
                updateUI();
            }
        }, 100);
    });

    // Like button functionality
    likeBtn.addEventListener('click', () => {
        likeVideo(currentIndex);
    });

    // Initialize
    window.addEventListener('load', () => {
        updateUI();
        playCurrentVideo();
    });

    // Keyboard navigation for accessibility
    window.addEventListener('keydown', (e) => {
        const currentVideo = videosContainer.querySelectorAll('video')[currentIndex];

        if (e.key === 'ArrowDown' || e.key === 'PageDown') {
            e.preventDefault();
            goToNextVideo();
        } else if (e.key === 'ArrowUp' || e.key === 'PageUp') {
            e.preventDefault();
            let prevIndex = currentIndex - 1;
            if (prevIndex < 0) prevIndex = videos.length - 1;
            scrollToVideo(prevIndex);
        }
        else if (e.key === 'Enter' || e.key === ' ') {  // Toggle play/pause on Enter or Space
            e.preventDefault();
            if (currentVideo.paused) {
                currentVideo.play().catch(() => {});
            } else {
                currentVideo.pause();
            }
        }
    });
</script>
</body>
</html>